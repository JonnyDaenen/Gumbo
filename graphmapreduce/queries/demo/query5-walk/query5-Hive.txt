



drop table if exists Walk1;
create table Walk1 (x int)
row format delimited fields terminated by ','
location '/user/cloudera/output/demo/hive/query5Walk1';


drop table if exists Walk2;
create table Walk2 (x int)
row format delimited fields terminated by ','
location '/user/cloudera/output/demo/hive/query5Walk2';

drop table if exists EW2;
create table EW2 (x int, y int, SEW2x boolean)
row format delimited fields terminated by ','
location '/user/cloudera/output/demo/hive/query5EW2';

drop table if exists EW1;
create table EW1 (x int, y int, SEW1x boolean)
row format delimited fields terminated by ','
location '/user/cloudera/output/demo/hive/query5EW1';

drop table if exists WExact1;
create table WExact1 (x int)
row format delimited fields terminated by ','
location '/user/cloudera/output/demo/hive/query5WExact1';

drop table if exists EW3;
create table EW3 (x int, y int, SEW3x boolean)
row format delimited fields terminated by ','
location '/user/cloudera/output/demo/hive/query5EW3';

drop table if exists Walk3;
create table Walk3 (x int)
row format delimited fields terminated by ','
location '/user/cloudera/output/demo/hive/query5Walk3';


drop table if exists EWExact1;
create table EWExact1 (x int, y int, SEWExact1x boolean)
row format delimited fields terminated by ','
location '/user/cloudera/output/demo/hive/query5EWExact1';


drop table if exists WExact2;
create table WExact2 (x int)
row format delimited fields terminated by ','
location '/user/cloudera/output/demo/hive/query5WExact2';


drop table if exists Walk4;
create table Walk4 (x int)
row format delimited fields terminated by ','
location '/user/cloudera/output/demo/hive/query5Walk4';


drop table if exists EWExact2;
create table EWExact2 (x int, y int, SEWExact2x boolean)
row format delimited fields terminated by ','
location '/user/cloudera/output/demo/hive/query5EWExact2';

drop table if exists WExact3;
create table WExact3 (x int)
row format delimited fields terminated by ','
location '/user/cloudera/output/demo/hive/query5WExact3';

drop table if exists EW4;
create table EW4 (x int, y int, SEW4x boolean)
row format delimited fields terminated by ','
location '/user/cloudera/output/demo/hive/query5EW4';





insert overwrite table Walk1 
select edge.x as x 
from E edge;

insert overwrite table Walk2
select edge.x as x
from E edge left outer join Walk1 p
on edge.y = p.x
where p.x is not null;

insert overwrite table EW2
select edge.x as x, edge.y as y, case when vertex.x IS null then false else true end as SEW2x
from E edge left outer join Walk2 vertex
on edge.x = vertex.x;

insert overwrite table EW1
select edge.x as x, edge.y as y, case when vertex.x IS null then false else true end as SEW1x
from E edge left outer join Walk1 vertex
on edge.y = vertex.x;

insert overwrite table WExact1 
select EW2.x as x
from EW2 left outer join EW1
on (EW2.x = EW1.x and EW2.y = EW1.y) 
where (SEW2x = false and SEW1x = false);

insert overwrite table Walk3
select edge.x as x
from E edge left outer join Walk2 p
on edge.y = p.x
where p.x is not null;

insert overwrite table EW3
select edge.x as x, edge.y as y, case when vertex.x IS null then false else true end as SEW3x
from E edge left outer join Walk3 vertex
on edge.x = vertex.x;

insert overwrite table EWExact1
select edge.x as x, edge.y as y, case when vertex.x IS null then false else true end as SEWExact1x
from E edge left outer join WExact1 vertex
on edge.y = vertex.x;

insert overwrite table WExact2
select EW3.x as x
from EW3 left outer join EWExact1
on (EW3.x = EWExact1.x and EW3.y = EWExact1.y) 
where (SEW3x = false and SEWExact1x = true);



insert overwrite table Walk4
select edge.x as x
from E edge left outer join Walk3 p
on edge.y = p.x
where p.x is not null;

insert overwrite table EW4
select edge.x as x, edge.y as y, case when vertex.x IS null then false else true end as SEW4x
from E edge left outer join Walk4 vertex
on edge.x = vertex.x;


insert overwrite table EWExact2
select edge.x as x, edge.y as y, case when vertex.x IS null then false else true end as SEWExact2x
from E edge left outer join WExact2 vertex
on edge.y = vertex.x;

insert overwrite table WExact3
select EW4.x as x
from EW4 left outer join EWExact2
on (EW4.x = EWExact2.x and EW4.y = EWExact2.y) 
where (SEW4x = false and SEWExact2x = true);







